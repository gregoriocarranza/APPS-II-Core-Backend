# Sundays Framework Project

This directory contains the starter backend generated by the CLI.

## Quick start

1. Install dependencies:
   ```bash
   npm install
   ```
2. Copy and configure environment variables:
   ```bash
   cp .env.example .env
   # then edit .env as needed
   ```
3. Start the dev server:
   ```bash
   npm run start:dev
   ```

The server will run on the port specified in `.env` (e.g., `PORT=3000`).

## Additional setup — Docker & database

Prerequisites
- Docker (AMD64)
- Node.js and npm

Steps
1. Install Docker (AMD64).
2. Install project dependencies:
   ```bash
   npm install
   ```
3. Add environment variables: download or copy `.env` to the repository root (you can start from `.env.example`).
4. Start background services with Docker Compose:
   ```bash
   docker-compose up -d
   ```
   To stop and remove volumes:
   ```bash
   docker-compose down -v
   ```
5. Once containers are ready, use the credentials in `.env` to access services (for example, RabbitMQ management UI).
6. Populate the database (migrations):
   ```bash
   npm run migrate:create
   npm run migrate:deploy
   ```


## API — Brief stack summary

### Language & runtime
- TypeScript + Node.js
- Project config: `package.json`
- TypeScript config: `tsconfig.json`

### Web framework
- Express
- App entry/config: `app.ts`
- Server bootstrap: `server.ts`

### Routing & project structure
- Auto-discovered routers mounted under `/api` via `IndexRouter` (see `src/routes/index.ts`)
- Typical pattern: Router → Controller → Service → DAO  
- Example: `WalletsRouter` → `WalletsController` → `WalletsService` → DAO (e.g., `UserDAO`)

### Database
- PostgreSQL accessed via Knex
- Connection manager: `KnexManager`
- Knex config: `knexfile.ts`
- Migrations: `migrations/` (e.g., `migrations/20251007231617_migration_user.ts`)

### Validation, middleware & error handling
- Request DTO validation: `bodyValidationMiddleware`
- Central error handler: `error.middleware.ts`

### Auth & email
- JWT auth: configuration in `authConfig`, logic in `AuthService`
- Emailer: `EmailerService`

### Dev & deploy
- Dev scripts and build configured in `package.json`
- Entrypoint: `server.ts`
- Docker compose: `docker-compose.yml`
- CI/CD: `deploy.yml`